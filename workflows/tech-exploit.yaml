id: foulenzer-tech-exploit
info:
  name: WebApp-Scan with automated bug scan
  author: foulenzer
variables:

  tech_detect: foulenzer-tech.yaml

  # cisco asa

  # confluence
  confluence_cve: cves/CVE-2018-5230.yaml
  confluence_cve2: cves/CVE-2019-3396.yaml

  # drupal
  drupal: security-misconfiguration/drupal-user-enum-ajax.yaml
  drupal2: security-misconfiguration/drupal-user-enum-redirect.yaml

  # jira

  # moodle

  # tomcat
  cve_2020_9484: cves/CVE-2020-9484.yaml
  public_tomcat_instance: files/public-tomcat-instance.yaml
  tomcat_scripts: files/tomcat-scripts.yaml
  tomcat_manager_pathnormalization: vulnerabilities/tomcat-manager-pathnormalization.yaml
  cve_2018_11759: cves/CVE-2018-11759.yaml
  tomcat_manager_default: default-credentials/tomcat-manager-default.yaml

  # wordpress
  wordpress_dir_listing: files/wordpress-directory-listing.yaml
  wordpress_user_enum: files/wordpress-user-enumeration.yaml
  wordpress_wpconfig: security-misconfiguration/wordpress-accessible-wpconfig.yaml
  wordpress_duplicator_path_traversal: vulnerabilities/wordpress-duplicator-path-traversal.yaml
  wordpress_wordfence_xss: vulnerabilities/wordpress-wordfence-xss.yaml
  wordpress_debug_log: files/wordpress-debug-log.yaml
  wordpress_db_backup: files/wordpress-db-backup.yaml
  wordpress_emergency_script: files/wordpress-emergency-script.yaml
  wordpress_installer_log: files/wordpress-installer-log.yaml
  wordpress_tmm_db_migrate: files/wordpress-tmm-db-migrate.yaml
  wordpress_social_metrics_tracker: vulnerabilities/wordpress-social-metrics-tracker.yaml
  wordpress_cve: cves/CVE-2019-9978.yaml
  wordpress_cve_2: cves/CVE-2019-6715.yaml
  wordpress_cve_3: cves/CVE-2020-24312.yaml
  wordpress_cve_4: cves/CVE-2019-6112.yaml
  wordpress_cve_5: cves/CVE-2018-18069.yaml
  wordpress_cve_6: cves/CVE-2019-19985.yaml
  wordpress_cve_7: cves/CVE-2019-15858.yaml
  wordpress_cve_8: cves/CVE-2017-14537.yaml
  wordpress_xmlrpc: files/wp-xmlrpc.yaml
  wordpress_woomails: vulnerabilities/wordpress-emails-verification-for-woocommerce.yaml
  
logic:
  |
  tech_detect()

  if tech_detect["atlassian-confluence"] {
    confluence_cve()
    confluence_cve2()
  }

  if tech_detect["drupal"] {
    drupal()
    drupal2()
  }

  if tech_detect["tomcat"] {
    cve_2020_9484()
    public_tomcat_instance()
    tomcat_scripts()
    tomcat_manager_pathnormalization()
    cve_2018_11759()
    tomcat_manager_default()
  }

  if tech_detect["wordpress"] {

    wordpress_dir_listing()
    wordpress_user_enum()
    wordpress_wpconfig()
    wordpress_duplicator_path_traversal()
    wordpress_wordfence_xss()
    wordpress_debug_log()
    wordpress_db_backup()
    wordpress_emergency_script()
    wordpress_installer_log()
    wordpress_tmm_db_migrate()
    wordpress_social_metrics_tracker()
    wordpress_cve()
    wordpress_cve_2()
    wordpress_cve_3()
    wordpress_cve_4()
    wordpress_cve_5()
    wordpress_cve_6()
    wordpress_cve_7()
    wordpress_cve_8()
    wordpress_xmlrpc()
    wordpress_woomails()

  }


id: foulenzer-tech
info:
  name: WebApp tech detection
  author: hakluke (edited by foulenzer)
  severity: info
requests:
  - method: GET
    path:
      - "{{BaseURL}}/"

    redirects: true
    max-redirects: 2
    matchers-condition: or
    matchers:
      - type: word
        name: atlassian-jira
        words:
          - "System Dashboard"
          - "atlassian.com/software/jira"
          - "/secure/QuickSearch.jspa"
          - "jira.core:"
        condition: or
        part: body

      - type: regex
        name: kibana
        regex:
          - <title>Kibana</title>
        condition: or
        part: body

      - type: regex
        name: cgit
        regex:
          - <[^>]+id='cgit'
          - generated by <a href='http://git\.zx2c4\.com/cgit/about/'>cgit v([\d.a-z-]+)</a>
        condition: or
        part: body

      - type: regex
        name: moodle
        regex:
          - moodle-filter
          - moodle
          - <img[^>]+moodlelogo
        condition: or
        part: body

      - type: regex
        name: woocommerce
        regex:
          - <!-- WooCommerce
          - <link rel='[^']+' id='woocommerce-(?:layout|smallscreen|general)-css'  href='https?://[^/]+/wp-content/plugins/woocommerce/assets/css/woocommerce(?:-layout|-smallscreen)?\.css?ver=([\d.]+)'
        condition: or
        part: body

      - type: regex
        name: cpanel
        regex:
          - <!-- cPanel
          - 2020 cPanel
        condition: or
        part: body

      - type: regex
        name: phpmyadmin
        regex:
          - '!\[CDATA\[[^<]*PMA_VERSION:\"([\d.]+)'
          - '(?: \| phpMyAdmin ([\d.]+)<\/title>|PMA_sendHeaderLocation\(|<link [^>]*href="[^"]*phpmyadmin\.css\.php)'
          - pma_username
          - phpMyAdmin
        condition: or
        part: body

      - type: regex
        name: prestashop
        regex:
          - Powered by <a\s+[^>]+>PrestaShop
          - <!-- /Block [a-z ]+ module (?:HEADER|TOP)?\s?-->
          - <!-- /Module Block [a-z ]+ -->
        condition: or
        part: body

      - type: regex
        name: oxid-eshop
        regex:
          - <!--[^-]*OXID eShop
          - (c) OXID eSales
        condition: or
        part: body

      - type: regex
        name: wordpress-super-cache
        regex:
          - <!--[^>]+WP-Super-Cache
        condition: or
        part: body

      - type: regex
        name: gravatar
        regex:
          - <[^>]+gravatar\.com/avatar/
        condition: or
        part: body

      - type: regex
        name: zabbix
        regex:
          - <body[^>]+zbxCallPostScripts
        condition: or
        part: body

      - type: regex
        name: phpbb
        regex:
          - Powered by <a[^>]+phpBB
          - <div class=phpbb_copyright>
          - <[^>]+styles/(?:sub|pro)silver/theme
          - <img[^>]+i_icon_mini
          - <table class="[^"]*forumline
        condition: or
        part: body

      - type: regex
        name: wpcache
        regex:
          - <!--[^>]+wpCache
        condition: or
        part: body

      - type: regex
        name: bugzilla
        regex:
          - href="enter_bug\.cgi">
          - <main id="bugzilla-body"
          - <a href="https?://www\.bugzilla\.org/docs/([0-9.]+)/[^>]+>Help<
          - <span id="information" class="header_addl_info">version ([\d.]+)<
        condition: or
        part: body

      - type: regex
        name: adminer
        regex:
          - Adminer</a> <span class="version">([\d.]+)</span>
          - onclick="bodyClick\(event\);" onload="verifyVersion\('([\d.]+)'\);">
        condition: or
        part: body

      - type: regex
        name: elementor
        regex:
          - <div class=(?:"|')[^"']*elementor
          - <section class=(?:"|')[^"']*elementor
          - <link [^>]*href=(?:"|')[^"']*elementor/assets
          - <link [^>]*href=(?:"|')[^"']*uploads/elementor/css
        condition: or
        part: body

      - type: regex
        name: shopware
        regex:
          - <title>Shopware ([\d\.]+) [^<]+
        condition: or
        part: body

      - type: regex
        name: jenkins
        regex:
          - <span class="jenkins_ver"><a href="https://jenkins\.io/">Jenkins ver\. ([\d.]+)
        condition: or
        part: body

      - type: regex
        name: koken
        regex:
          - <html lang="en" class="k-source-essays k-lens-essays">
          - <!--\s+KOKEN DEBUGGING
        condition: or
        part: body

      - type: regex
        name: outlook-web-app
        regex:
          - <link\s[^>]*href="[^"]*?([\d.]+)/themes/resources/owafont\.css
          - \/owa\/auth
        condition: or
        part: body

      - type: regex
        name: wordpress
        regex:
          - <link rel=["']stylesheet["'] [^>]+/wp-(?:content|includes)/
          - <link[^>]+s\d+\.wp\.com
        condition: or
        part: body
   
      - type: regex
        name: drupal-commerce
        regex:
          - <[^>]+(?:id="block[_-]commerce[_-]cart[_-]cart|class="commerce[_-]product[_-]field)
        condition: or
        part: body
 
      - type: regex
        name: gitlab
        regex:
          - <meta content="https?://[^/]+/assets/gitlab_logo-
          - <header class="navbar navbar-fixed-top navbar-gitlab with-horizontal-nav">
        condition: or
        part: body

      - type: regex
        name: redmine
        regex:
          - Powered by <a href="[^>]+Redmine
        condition: or
        part: body

      - type: regex
        name: vbulletin
        regex:
          - <div id="copyright">Powered by vBulletin
        condition: or

      - type: word
        name: vbulletin
        words:
          - "vBulletin.version"
          - 'content="vBulletin'
        part: body

      - type: regex
        name: mailchimp
        regex:
          - <form [^>]*data-mailchimp-url
          - <form [^>]*id="mc-embedded-subscribe-form"
          - <form [^>]*name="mc-embedded-subscribe-form"
          - <input [^>]*id="mc-email"
          - <!-- Begin MailChimp Signup Form -->
        condition: or
        part: body

        name: typo3-cms
        regex:
          - <link[^>]+ href="/?typo3(?:conf|temp)/
          - <img[^>]+ src="/?typo3(?:conf|temp)/
          - "<!--\n\tThis website is powered by TYPO3"
        condition: or
        part: body

      - type: regex
        name: php-fusion
        regex:
          - Powered by <a href="[^>]+php-fusion
        condition: or
        part: body

        name: wp-statistics
        regex:
          - <!-- Analytics by WP-Statistics v([\d.]+) -
        condition: or
        part: body

      - type: regex
        name: squarespace
        regex:
          - <!-- This is Squarespace\. -->
        condition: or
        part: body

      - type: regex
        name: gitlist
        regex:
          - <p>Powered by <a[^>]+>GitList ([\d.]+)
        condition: or
        part: body

      - type: regex
        name: joomla
        regex:
          - (?:<div[^>]+id="wrapper_r"|<(?:link|script)[^>]+(?:feed|components)/com_|<table[^>]+class="pill)
          - content\=\"Joomla\!
        condition: or
        part: body

      - type: regex
        name: magento
        regex:
          - <script [^>]+data-requiremodule="mage/
          - <script [^>]+data-requiremodule="Magento_
          - <script type="text/x-magento-init">
        condition: or
        part: body

      - type: regex
        name: oscommerce
        regex:
          - <br />Powered by <a href="https?://www\.oscommerce\.com
          - <(?:input|a)[^>]+name="osCsid"
          - <(?:tr|td|table)class="[^"]*infoBoxHeading
        condition: or
        part: body

      - type: regex
        name: mantisbt
        regex:
          - <img[^>]+ alt="Powered by Mantis Bugtracker
        condition: or
        part: body

      - type: regex
        name: squirrelmail
        regex:
          - '<small>SquirrelMail version ([.\d]+)[^<]*<br '
        condition: or
        part: body

      - type: regex
        name: gambio
        regex:
          - (?:<link[^>]* href="templates/gambio/|<a[^>]content\.php\?coID=\d|<!-- gambio eof -->|<!--[\s=]+Shopsoftware by Gambio GmbH \(c\))
        condition: or
        part: body

      - type: regex
        name: dreamweaver
        regex:
          - <!--[^>]*(?:InstanceBeginEditable|Dreamweaver([^>]+)target|DWLayoutDefaultTable)
        condition: or
        part: body

      - type: regex
        name: atlassian-confluence
        regex:
          - Powered by <a href=[^>]+atlassian\.com/software/confluence(?:[^>]+>Atlassian Confluence</a> ([\d.]+))?
        condition: or
        part: body

      - type: regex
        name: drupal
        regex:
          - <(?:link|style)[^>]+"/sites/(?:default|all)/(?:themes|modules)/
          - "X-Drupal"
          - "x-drupal"
          - "X-Generator: Drupal"
        condition: or
        part: all

      - type: regex
        name: gitweb
        regex:
          - <!-- git web interface version ([\d.]+)?
        condition: or
        part: body

        name: mediawiki
        regex:
          - <body[^>]+class="mediawiki"
          - <(?:a|img)[^>]+>Powered by MediaWiki</a>
          - <a[^>]+/Special:WhatLinksHere/
        condition: or
        part: body

      - type: regex
        name: yoast-seo
        regex:
          - <!-- This site is optimized with the Yoast (?:WordPress )?SEO plugin v([\d.]+) -
        condition: or
        part: body

      - type: regex
        name: splunk
        regex:
          - '<p class="footer">&copy; [-\d]+ Splunk Inc\.(?: Splunk ([\d\.]+(?: build [\d\.]*\d)?))?[^<]*</p>'
        condition: or
        part: body

      - type: regex
        name: gitea
        regex:
          - '<div class="ui left">\n\s+Â© Gitea Version: ([\d.]+)'
        condition: or
        part: body
  
      - type: regex
        name: all-in-one-seo-pack
        regex:
          - '<!-- All in One SEO Pack ([\d.]+) '
        condition: or
        part: body

      - type: regex
        name: wp-rocket
        regex:
          - <!--[^>]+WP Rocket
        condition: or
        part: body

      - type: regex
        name: shopify
        regex:
          - <link[^>]+=['"]//cdn\.shopify\.com
        condition: or
        part: body

      - type: regex
        name: roundcube
        regex:
          - <title>RoundCube
          - The Roundcube Dev Team
        condition: or
        part: body

      - type: regex
        name: webflow
        regex:
          - <html[^>]+data-wf-site
        condition: or
        part: body

      - type: regex
        name: owncloud
        regex:
          - <a href="https://owncloud\.com" target="_blank">ownCloud Inc\.</a><br/>Your Cloud, Your Data, Your Way!
          - _oc_debug
        condition: or
        part: body

      - type: regex
        name: atlassian-bitbucket
        regex:
          - <li>Atlassian Bitbucket <span title="[a-z0-9]+" id="product-version" data-commitid="[a-z0-9]+" data-system-build-number="[a-z0-9]+"> v([\d.]+)<
        condition: or
        part: body

      - type: word
        name: tomcat
        words:
          - "Tomcat"
        part: header

      - type: word
        name: jenkins
        words:
          - "X-Jenkins"
        part: header

      - type: word
        name: akamai
        words:
          - "AkamaiGHost"
        part: header
  